(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{rdpw:function(e,t,i){"use strict";i.r(t),i.d(t,"ClienteModule",(function(){return x}));var n=i("SVse"),c=i("s7LF"),s=i("iInd"),b=i("HDdC"),r=i("D0XW"),a=i("Y7HM");function o(e=0,t=r.a){return(!Object(a.a)(e)||e<0)&&(e=0),t&&"function"==typeof t.schedule||(t=r.a),new b.a(i=>(i.add(t.schedule(d,e,{subscriber:i,counter:0,period:e})),i))}function d(e){const{subscriber:t,counter:i,period:n}=e;t.next(i),this.schedule({subscriber:t,counter:i+1,period:n},n)}var l=i("lJxs"),u=i("IzEk"),p=i("vkgz"),h=i("1G5W"),v=i("8Y7J"),m=i("TGE+"),k=i("Gyf/"),g=i("zHaW"),f=i("Tj54");function P(e,t){1&e&&(v.Qb(0,"span"),v.Qb(1,"mat-icon",17),v.pc(2,"directions_walk"),v.Pb(),v.Pb())}function Q(e,t){if(1&e&&(v.Qb(0,"div"),v.Qb(1,"div",18),v.Qb(2,"div",1),v.pc(3," Atendiendo turno "),v.Pb(),v.Pb(),v.Qb(4,"div",18),v.Qb(5,"div",19),v.pc(6),v.Pb(),v.Pb(),v.Pb()),2&e){const e=v.Zb();v.zb(6),v.rc(" ",e.ticket.id_ticket," ")}}function w(e,t){1&e&&(v.Qb(0,"span"),v.pc(1," Disponible para atender "),v.Pb())}function y(e,t){if(1&e&&(v.Qb(0,"div",20),v.oc(1,w,2,0,"span",4),v.Pb()),2&e){const e=v.Zb();v.zb(1),v.ec("ngIf",!e.loading)}}function T(e,t){if(1&e&&(v.Qb(0,"div",21),v.pc(1),v.Pb()),2&e){const e=v.Zb();v.zb(1),v.qc(e.message)}}let C=(()=>{class e{constructor(e,t,i,n){this.activatedRoute=e,this.ticketsService=t,this.wsService=i,this.snack=n,this.waitForClient=!1,this.comingClient=!1,this.pendingTickets=0,this.timerCount=10,this.tmWaiting="--:--:--",this.tmAttention="--:--:--",this.loading=!1,this.activatedRoute.params.subscribe(e=>{this.idDesk=e.id})}ngOnInit(){this.wsService.escucharTurnos().subscribe(e=>{this.pendingTickets=Number(e)}),this.ticketsService.getPendingTicket(this.idDesk).subscribe(e=>{this.ticket=e.ok?e.ticket:null,this.pendingTickets=e.pending})}atenderTicket(){this.clearSession(),this.ticketsService.atenderTicket(this.idDesk,this.wsService.idSocket).subscribe(e=>{if(e.ok){this.waitForClient=!0,this.message="",this.ticket=e.ticket,this.tmWaiting=this.ticketsService.getTimeInterval(e.ticket.tm_start,e.ticket.tm_att);const t=this.wsService.escucharEnCamino(),i=o(1e3).pipe(Object(l.a)(e=>e+1),Object(u.a)(10));let n=!1;i.pipe(Object(p.a)(e=>this.timerCount=10-e),Object(h.a)(t)).subscribe(e=>{e>=9&&(n=!0)},void 0,()=>{new Promise(e=>{n?(this.waitForClient=!1,this.comingClient=!1,e()):(this.waitForClient=!0,this.comingClient=!0,o(1e3).pipe(Object(l.a)(e=>e+1),Object(u.a)(20)).subscribe(e=>this.timerCount=20-e,void 0,()=>{this.waitForClient=!1,this.comingClient=!1,e()}))}).then(()=>{const e=o(1e3),t=(new Date).getTime(),i=e.subscribe(()=>{this.ticket?this.tmAttention=this.ticketsService.getTimeInterval(t,+new Date):i.unsubscribe()})})})}else this.waitForClient=!1,this.message=e.msg,this.snack.open(e.msg,"ACEPTAR",{duration:2e3})})}sendMessage(e){this.wsService.idSocket?e.value.length>0&&(this.wsService.emit("mensaje-privado",{mensaje:e.value}),e.value=""):this.snack.open("Se perdi\xf3 la conexi\xf3n con el escritorio.","ACEPTAR",{duration:5e3})}atenderInformes(){}devolverTicket(){this.clearSession(),this.ticketsService.devolverTicket(this.idDesk).subscribe(e=>{this.message=e.msg})}finalizarTicket(){this.clearSession(),this.ticketsService.finalizarTicket(this.idDesk).subscribe(e=>{this.message=e.msg})}clearSession(){this.ticketsService.chatMessages=[],this.ticket=null,this.tmWaiting="--:--:--",this.tmAttention="--:--:--"}}return e.\u0275fac=function(t){return new(t||e)(v.Lb(s.a),v.Lb(m.a),v.Lb(k.a),v.Lb(g.a))},e.\u0275cmp=v.Fb({type:e,selectors:[["app-escritorio"]],decls:51,vars:13,consts:[[1,"row","p-3"],[1,"col"],[1,"card","text-white","bg-danger","mb-4"],[1,"card-header","banner-title"],[4,"ngIf"],[1,"banner-content",2,"background-color","rgb(141, 51, 51)"],[1,"container"],["class","my-4",4,"ngIf"],["class","card bg-danger text-white my-4 py-2",4,"ngIf"],[1,"row","banner-footer"],[1,"col","p-0"],[1,"row","py-2"],[1,"my-2","col-md-3","col-sm-6","col-xs-12"],[1,"btn","btn-info","btn-block","btn-lg",3,"disabled","click"],[1,"btn","btn-success","btn-block","btn-lg",3,"disabled","click"],[1,"btn","btn-primary","btn-block","btn-lg",3,"disabled","click"],[1,"btn","btn-danger","btn-block","btn-lg",3,"disabled","click"],[2,"float","right","color","yellow","font-size","x-large"],[1,"row"],[1,"col","xxxxl"],[1,"my-4"],[1,"card","bg-danger","text-white","my-4","py-2"]],template:function(e,t){1&e&&(v.Qb(0,"div",0),v.Qb(1,"div",1),v.Qb(2,"div",2),v.Qb(3,"div",3),v.Qb(4,"span"),v.pc(5),v.Pb(),v.oc(6,P,3,0,"span",4),v.Pb(),v.Qb(7,"div",5),v.Qb(8,"div",6),v.oc(9,Q,7,1,"div",4),v.oc(10,y,2,1,"div",7),v.oc(11,T,2,1,"div",8),v.Qb(12,"div",9),v.Qb(13,"div",10),v.Qb(14,"div"),v.pc(15,"TE"),v.Pb(),v.Qb(16,"div"),v.pc(17),v.Pb(),v.Pb(),v.Qb(18,"div",10),v.Qb(19,"div"),v.pc(20,"TA"),v.Pb(),v.Qb(21,"div"),v.pc(22),v.Pb(),v.Pb(),v.Qb(23,"div",10),v.Qb(24,"div"),v.pc(25,"Tm"),v.Pb(),v.Qb(26,"div"),v.pc(27),v.Pb(),v.Pb(),v.Qb(28,"div",10),v.Qb(29,"div"),v.pc(30,"TC"),v.Pb(),v.Qb(31,"div"),v.pc(32),v.Pb(),v.Pb(),v.Pb(),v.Pb(),v.Pb(),v.Pb(),v.Qb(33,"div",2),v.Qb(34,"div",3),v.pc(35," Panel "),v.Pb(),v.Qb(36,"div",5),v.Qb(37,"div",6),v.Qb(38,"div",11),v.Qb(39,"div",12),v.Qb(40,"button",13),v.Xb("click",(function(){return t.atenderInformes()})),v.pc(41," Informes "),v.Pb(),v.Pb(),v.Qb(42,"div",12),v.Qb(43,"button",14),v.Xb("click",(function(){return t.atenderTicket()})),v.pc(44," Siguiente "),v.Pb(),v.Pb(),v.Qb(45,"div",12),v.Qb(46,"button",15),v.Xb("click",(function(){return t.devolverTicket()})),v.pc(47," Devolver "),v.Pb(),v.Pb(),v.Qb(48,"div",12),v.Qb(49,"button",16),v.Xb("click",(function(){return t.finalizarTicket()})),v.pc(50," Finalizar "),v.Pb(),v.Pb(),v.Pb(),v.Pb(),v.Pb(),v.Pb(),v.Pb(),v.Pb()),2&e&&(v.zb(5),v.rc(" ESCRITORIO ",t.idDesk," "),v.zb(1),v.ec("ngIf",t.comingClient),v.zb(3),v.ec("ngIf",t.ticket),v.zb(1),v.ec("ngIf",!t.ticket),v.zb(1),v.ec("ngIf",t.message),v.zb(6),v.qc(t.tmWaiting),v.zb(5),v.qc(t.tmAttention),v.zb(5),v.qc(t.timerCount),v.zb(5),v.qc(t.pendingTickets),v.zb(8),v.ec("disabled",t.waitForClient),v.zb(3),v.ec("disabled",t.waitForClient),v.zb(3),v.ec("disabled",t.waitForClient),v.zb(3),v.ec("disabled",t.waitForClient))},directives:[n.j,f.a],styles:[""]}),e})(),z=(()=>{class e{constructor(e){this.router=e}ngOnInit(){}entrar(e){e&&this.router.navigate(["/cliente/escritorio",e])}}return e.\u0275fac=function(t){return new(t||e)(v.Lb(s.b))},e.\u0275cmp=v.Fb({type:e,selectors:[["app-home-cliente"]],decls:16,vars:0,consts:[[1,"jumbotron","m-2"],[1,"display-4"],[1,"lead"],[1,"my-4"],["name","escritorio","type","number","placeholder","Escritorio","required","",1,"form-control",3,"keyup.enter"],["txtEscritorio",""],["role","button",1,"btn","btn-success","btn-block",3,"click"],["href","#","role","button",1,"btn","btn-primary","btn-lg"]],template:function(e,t){if(1&e){const e=v.Rb();v.Qb(0,"div",0),v.Qb(1,"h1",1),v.pc(2,"Bienvenido a la web del cliente"),v.Pb(),v.Qb(3,"p",2),v.pc(4,"Bienvenido, desde aqu\xed puede sacar un turno y evitar la sala de esperas."),v.Pb(),v.Qb(5,"div",3),v.Qb(6,"input",4,5),v.Xb("keyup.enter",(function(){v.ic(e);const i=v.hc(7);return t.entrar(i.value)})),v.Pb(),v.Pb(),v.Qb(8,"div"),v.Qb(9,"button",6),v.Xb("click",(function(){v.ic(e);const i=v.hc(7);return t.entrar(i.value)})),v.pc(10,"Ingresar"),v.Pb(),v.Pb(),v.Mb(11,"hr",3),v.Qb(12,"p"),v.pc(13," Desde ac\xe1 podes ingresar a una ventanilla de atenci\xf3n. Desde el chat podra ver las consultas de los clientes una vez se les haya asignado esta ventanilla. Si desea puede tambi\xe9n atender consultas desde la ventanilla de informes para todas las consultas que todav\xeda permanecen en espera. "),v.Pb(),v.Qb(14,"a",7),v.pc(15,"Dashboard"),v.Pb(),v.Pb()}},styles:[""]}),e})();var S=i("AIE+");const I=[{path:"escritorio/:id",component:C},{path:"dashboard",component:(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=v.Fb({type:e,selectors:[["app-dashboard"]],decls:2,vars:0,template:function(e,t){1&e&&(v.Qb(0,"p"),v.pc(1,"dashboard works!"),v.Pb())},styles:[""]}),e})()},{path:"home",component:z},{path:"",redirectTo:"/cliente/home",pathMatch:"full"},{path:"**",component:S.a}];let j=(()=>{class e{}return e.\u0275mod=v.Jb({type:e}),e.\u0275inj=v.Ib({factory:function(t){return new(t||e)},imports:[[s.e.forChild(I)],s.e]}),e})();var D=i("1+r1"),F=i("j1ZV");let x=(()=>{class e{}return e.\u0275mod=v.Jb({type:e}),e.\u0275inj=v.Ib({factory:function(t){return new(t||e)},imports:[[n.b,c.m,c.g,D.a,F.a,j]]}),e})()}}]);